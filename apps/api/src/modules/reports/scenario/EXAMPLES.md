# Scenario Planning - Usage Examples

## Chat Interface Examples

### Example 1: Hiring Scenario

**User Question:**
```
Was wenn ich 2 Entwickler fÃ¼r â‚¬5.000 pro Monat einstelle?
```

**Bot Response:**
```
âš ï¸ Szenario-Analyse: Neue Einstellung

2 neue Mitarbeiter fÃ¼r â‚¬5.000/Monat

Aktuelle Situation:
â€¢ Monatliche Einnahmen: â‚¬25.000,00
â€¢ Monatliche Ausgaben: â‚¬15.000,00
â€¢ Burn Rate: â‚¬0,00/Monat
â€¢ Runway: âˆž Monate

Nach Ã„nderung:
â€¢ Monatliche Einnahmen: â‚¬25.000,00
â€¢ Monatliche Ausgaben: â‚¬25.000,00
â€¢ Burn Rate: â‚¬0,00/Monat
â€¢ Runway: âˆž Monate

Auswirkung:
â€¢ Runway-Ã„nderung: Bleibt profitabel
â€¢ Monatliche Ã„nderung: -â‚¬10.000,00

Empfehlung:
VORSICHT: Diese Ã„nderung wÃ¼rde das monatliche Netto von â‚¬10.000 auf â‚¬0 reduzieren.
Kein Puffer mehr fÃ¼r unerwartete Ausgaben.
```

### Example 2: Revenue Increase

**User Question:**
```
Was wenn der Umsatz um 30% steigt?
```

**Bot Response:**
```
âœ… Szenario-Analyse: Umsatzsteigerung

Umsatz um 30% erhÃ¶hen

Aktuelle Situation:
â€¢ Monatliche Einnahmen: â‚¬20.000,00
â€¢ Monatliche Ausgaben: â‚¬18.000,00
â€¢ Burn Rate: â‚¬0,00/Monat
â€¢ Runway: âˆž Monate

Nach Ã„nderung:
â€¢ Monatliche Einnahmen: â‚¬26.000,00
â€¢ Monatliche Ausgaben: â‚¬18.000,00
â€¢ Burn Rate: â‚¬0,00/Monat
â€¢ Runway: âˆž Monate

Auswirkung:
â€¢ Runway-Ã„nderung: Bleibt profitabel
â€¢ Monatliche Ã„nderung: +â‚¬6.000,00

Empfehlung:
POSITIV: Diese Ã„nderung wÃ¼rde das monatliche Netto um â‚¬6.000 erhÃ¶hen.
```

### Example 3: Cost Savings

**User Question:**
```
Was wenn wir â‚¬3.000 monatlich an Kosten einsparen?
```

**Bot Response:**
```
âœ… Szenario-Analyse: Kosteneinsparung

â‚¬3.000/Monat einsparen

Aktuelle Situation:
â€¢ Monatliche Einnahmen: â‚¬15.000,00
â€¢ Monatliche Ausgaben: â‚¬18.000,00
â€¢ Burn Rate: â‚¬3.000,00/Monat
â€¢ Runway: 10,0 Monate

Nach Ã„nderung:
â€¢ Monatliche Einnahmen: â‚¬15.000,00
â€¢ Monatliche Ausgaben: â‚¬15.000,00
â€¢ Burn Rate: â‚¬0,00/Monat
â€¢ Runway: âˆž Monate

Auswirkung:
â€¢ Runway-Ã„nderung: âˆž (profitabel!)
â€¢ Monatliche Ã„nderung: +â‚¬3.000,00

Empfehlung:
POSITIV: Diese Ã„nderung wÃ¼rde das Unternehmen profitabel machen.
```

### Example 4: Investment Scenario

**User Question:**
```
Was wenn wir eine Investition von â‚¬50.000 tÃ¤tigen?
```

**Bot Response:**
```
âš¡ Szenario-Analyse: Investition

Einmalige Investition von â‚¬50.000

Aktuelle Situation:
â€¢ Monatliche Einnahmen: â‚¬20.000,00
â€¢ Monatliche Ausgaben: â‚¬15.000,00
â€¢ Burn Rate: â‚¬0,00/Monat
â€¢ Runway: âˆž Monate

Nach Ã„nderung:
â€¢ Monatliche Einnahmen: â‚¬20.000,00
â€¢ Monatliche Ausgaben: â‚¬15.000,00
â€¢ Burn Rate: â‚¬0,00/Monat
â€¢ Runway: âˆž Monate

Auswirkung:
â€¢ Runway-Ã„nderung: Bleibt profitabel
â€¢ Monatliche Ã„nderung: â‚¬0,00
â€¢ Cashbestand reduziert um â‚¬50.000

Empfehlung:
NEUTRAL: Einmalige Investition reduziert Cashbestand, aber monatlicher Cash Flow bleibt positiv.
```

### Example 5: Critical Scenario

**User Question:**
```
Was wenn ich 5 Entwickler fÃ¼r â‚¬6.000 pro Monat einstelle?
```

**Bot Response:**
```
ðŸš¨ Szenario-Analyse: Neue Einstellung

5 neue Mitarbeiter fÃ¼r â‚¬6.000/Monat

Aktuelle Situation:
â€¢ Monatliche Einnahmen: â‚¬25.000,00
â€¢ Monatliche Ausgaben: â‚¬15.000,00
â€¢ Burn Rate: â‚¬0,00/Monat
â€¢ Runway: âˆž Monate

Nach Ã„nderung:
â€¢ Monatliche Einnahmen: â‚¬25.000,00
â€¢ Monatliche Ausgaben: â‚¬45.000,00
â€¢ Burn Rate: â‚¬20.000,00/Monat
â€¢ Runway: 2,5 Monate

Auswirkung:
â€¢ Runway-Ã„nderung: Von profitabel zu 2,5 Monate
â€¢ Monatliche Ã„nderung: -â‚¬30.000,00

Empfehlung:
KRITISCH: Diese Ã„nderung wÃ¼rde zu hohem monatlichen Verlust fÃ¼hren.
Runway nur 2,5 Monate. ZusÃ¤tzliche Einnahmen von â‚¬30.000/Monat erforderlich oder schrittweise Einstellung empfohlen.
```

### Example 6: English Query

**User Question:**
```
What if I hire 3 developers at â‚¬4,500 per month?
```

**Bot Response:**
```
âš ï¸ Szenario-Analyse: Neue Einstellung

3 neue Mitarbeiter fÃ¼r â‚¬4.500/Monat

Aktuelle Situation:
â€¢ Monatliche Einnahmen: â‚¬30.000,00
â€¢ Monatliche Ausgaben: â‚¬20.000,00
â€¢ Burn Rate: â‚¬0,00/Monat
â€¢ Runway: âˆž Monate

Nach Ã„nderung:
â€¢ Monatliche Einnahmen: â‚¬30.000,00
â€¢ Monatliche Ausgaben: â‚¬33.500,00
â€¢ Burn Rate: â‚¬3.500,00/Monat
â€¢ Runway: 14,3 Monate

Auswirkung:
â€¢ Runway-Ã„nderung: Von profitabel zu 14,3 Monate
â€¢ Monatliche Ã„nderung: -â‚¬13.500,00

Empfehlung:
VORSICHT: Runway wÃ¼rde sich um erheblich verkÃ¼rzen.
ZusÃ¤tzliche Einnahmen oder gestaffelte Einstellung erwÃ¤gen.
```

## Programmatic Examples

### Example 1: Simple Scenario Calculation

```typescript
import { ScenarioPlanningService } from '@/modules/reports/scenario';

@Injectable()
export class FinanceAnalysisService {
  constructor(private scenarioService: ScenarioPlanningService) {}

  async analyzeHiring() {
    const result = await this.scenarioService.calculateScenario('org-123', {
      name: 'Hire 2 Developers',
      description: 'Add 2 senior developers to the team',
      changes: {
        newHires: {
          count: 2,
          monthlySalary: 5000,
        },
      },
    });

    console.log(`Risk Level: ${result.riskLevel}`);
    console.log(`Runway Change: ${result.impact.runwayChange} months`);
    console.log(`Recommendation: ${result.recommendation}`);

    return result;
  }
}
```

### Example 2: Compare Multiple Scenarios

```typescript
async compareCostCutOptions(orgId: string) {
  const scenarios = [
    {
      name: '5% Cost Cut',
      changes: { expenseChangePercent: -5 },
    },
    {
      name: '10% Cost Cut',
      changes: { expenseChangePercent: -10 },
    },
    {
      name: '15% Cost Cut',
      changes: { expenseChangePercent: -15 },
    },
  ];

  const results = await this.scenarioService.compareScenarios(orgId, scenarios);

  // Find best option (highest runway increase, lowest risk)
  const best = results
    .filter(r => r.riskLevel !== 'critical')
    .sort((a, b) => b.impact.runwayChange - a.impact.runwayChange)[0];

  return {
    best: best.scenario.name,
    allResults: results,
  };
}
```

### Example 3: Complex Multi-Change Scenario

```typescript
async analyzeBigPlan(orgId: string) {
  const result = await this.scenarioService.calculateScenario(orgId, {
    name: 'Growth Plan',
    description: 'Hire 3 people, increase revenue 25%, make one-time investment',
    changes: {
      newHires: { count: 3, monthlySalary: 4500 },
      revenueChangePercent: 25,
      oneTimeExpense: 30000, // Marketing campaign
    },
  });

  return result;
}
```

### Example 4: Revenue Optimization Analysis

```typescript
async findBreakEvenRevenue(orgId: string, currentRevenue: number) {
  const increments = [5, 10, 15, 20, 25, 30, 40, 50];

  for (const percent of increments) {
    const result = await this.scenarioService.calculateScenario(orgId, {
      name: `Revenue +${percent}%`,
      changes: { revenueChangePercent: percent },
    });

    if (result.projected.monthlyNet >= 0) {
      return {
        percentNeeded: percent,
        newRevenue: currentRevenue * (1 + percent / 100),
        result,
      };
    }
  }

  return null; // No break-even found in tested range
}
```

### Example 5: Optimization Suggestions

```typescript
async getOptimizationSuggestions(orgId: string) {
  // Get pre-built optimization scenarios
  const suggestions = await this.scenarioService.suggestOptimizations(orgId);

  // Filter to only positive or neutral impact
  const viable = suggestions.filter(
    s => s.riskLevel === 'low' || s.riskLevel === 'medium'
  );

  // Sort by runway improvement
  viable.sort((a, b) => b.impact.runwayChange - a.impact.runwayChange);

  return viable;
}
```

### Example 6: Conditional Scenario Planning

```typescript
async planConditionalStrategy(orgId: string) {
  // Get baseline
  const baseline = await this.getBaselineMetrics(orgId);

  let strategy;

  if (baseline.runwayMonths < 3) {
    // Critical: Focus on cost cutting
    strategy = await this.scenarioService.calculateScenario(orgId, {
      name: 'Emergency Cost Cut',
      changes: { expenseChangePercent: -20 },
    });
  } else if (baseline.runwayMonths < 6) {
    // Caution: Balanced approach
    strategy = await this.scenarioService.calculateScenario(orgId, {
      name: 'Balanced Growth',
      changes: {
        revenueChangePercent: 15,
        expenseChangePercent: -5,
      },
    });
  } else {
    // Healthy: Can invest in growth
    strategy = await this.scenarioService.calculateScenario(orgId, {
      name: 'Aggressive Growth',
      changes: {
        newHires: { count: 2, monthlySalary: 5000 },
        revenueChangePercent: 30,
        oneTimeExpense: 50000,
      },
    });
  }

  return strategy;
}
```

## REST API Examples

### Calculate Scenario (hypothetical endpoint)

```bash
POST /api/reports/scenarios/calculate
Authorization: Bearer {token}
Content-Type: application/json

{
  "scenario": {
    "name": "Hire 2 Developers",
    "changes": {
      "newHires": {
        "count": 2,
        "monthlySalary": 5000
      }
    }
  }
}
```

**Response:**
```json
{
  "scenario": {
    "name": "Hire 2 Developers",
    "changes": {
      "newHires": {
        "count": 2,
        "monthlySalary": 5000
      }
    }
  },
  "baseline": {
    "currentBalance": 50000,
    "monthlyIncome": 25000,
    "monthlyExpenses": 15000,
    "monthlyNet": 10000,
    "burnRate": 0,
    "runwayMonths": Infinity
  },
  "projected": {
    "currentBalance": 50000,
    "monthlyIncome": 25000,
    "monthlyExpenses": 25000,
    "monthlyNet": 0,
    "burnRate": 0,
    "runwayMonths": Infinity
  },
  "impact": {
    "burnRateChange": 0,
    "runwayChange": 0,
    "monthlyNetChange": -10000
  },
  "recommendation": "VORSICHT: Diese Ã„nderung wÃ¼rde das monatliche Netto auf â‚¬0 reduzieren.",
  "riskLevel": "medium"
}
```

### Compare Scenarios (hypothetical endpoint)

```bash
POST /api/reports/scenarios/compare
Authorization: Bearer {token}
Content-Type: application/json

{
  "scenarios": [
    {
      "name": "Option A: Cost Cut",
      "changes": { "expenseChangePercent": -10 }
    },
    {
      "name": "Option B: Revenue Up",
      "changes": { "revenueChangePercent": 15 }
    },
    {
      "name": "Option C: Both",
      "changes": {
        "expenseChangePercent": -5,
        "revenueChangePercent": 10
      }
    }
  ]
}
```

## Error Handling Examples

### Invalid Scenario

```typescript
try {
  const result = await scenarioService.calculateScenario(orgId, {
    name: 'Invalid',
    changes: {}, // No changes specified
  });
} catch (error) {
  // Service will return baseline = projected
  // Impact will show all zeros
  // Recommendation: "NEUTRAL: Diese Ã„nderung hat keinen Einfluss"
}
```

### Missing Financial Data

```typescript
try {
  const result = await scenarioService.calculateScenario('new-org-id', scenario);
} catch (error) {
  // Falls back to safe defaults (all zeros)
  // Returns user-friendly message
  console.log('No financial data available yet');
}
```

## Integration Examples

### Frontend React Component

```typescript
const ScenarioAnalyzer = () => {
  const [query, setQuery] = useState('');
  const [result, setResult] = useState(null);

  const analyzeScenario = async () => {
    const response = await fetch('/api/chat/quick-ask', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        Authorization: `Bearer ${token}`,
      },
      body: JSON.stringify({
        question: query,
      }),
    });

    const data = await response.json();
    setResult(data.answer);
  };

  return (
    <div>
      <input
        value={query}
        onChange={e => setQuery(e.target.value)}
        placeholder="Was wenn ich 2 Entwickler einstelle?"
      />
      <button onClick={analyzeScenario}>Analysieren</button>
      {result && <div className="result">{result}</div>}
    </div>
  );
};
```

### Dashboard Widget

```typescript
const ScenarioSuggestions = ({ orgId }) => {
  const [suggestions, setSuggestions] = useState([]);

  useEffect(() => {
    // Get optimization suggestions
    scenarioService.suggestOptimizations(orgId).then(setSuggestions);
  }, [orgId]);

  return (
    <div className="widget">
      <h3>Optimization Opportunities</h3>
      {suggestions.map(s => (
        <div key={s.scenario.name} className={`suggestion ${s.riskLevel}`}>
          <h4>{s.scenario.name}</h4>
          <p>{s.recommendation}</p>
          <div className="metrics">
            <span>Runway: {s.impact.runwayChange > 0 ? '+' : ''}{s.impact.runwayChange.toFixed(1)}m</span>
            <span>Monthly: â‚¬{s.impact.monthlyNetChange.toFixed(0)}</span>
          </div>
        </div>
      ))}
    </div>
  );
};
```
